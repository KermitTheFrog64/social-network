{"ast":null,"code":"import _regeneratorRuntime from\"/home/natalie/ReactProjects/01/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/natalie/ReactProjects/01/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/home/natalie/ReactProjects/01/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/natalie/ReactProjects/01/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{userAPI}from\"../api/api\";import{updateObjectInArray}from\"../utils/object-helper\";var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET-USERS';var SET_CURRENT_PAGE='SET-CURRENT-PAGE';var SET_TOTAL_USERS_COUNT='SET-TOTAL-USERS-COUNT';var TOGGLE_IS_FETCHING='TOGGLE-IS-FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE-IS-FOLLOWING-PROGRESS';var initialState={users:[],pageSize:10,totalUsersCount:0,currentPage:1,isFetching:true,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:true})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:false})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:action.users});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_TOTAL_USERS_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.count});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FOLLOWING_PROGRESS:return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});default:return state;}};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,count:totalUsersCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};export var requestUsers=function requestUsers(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));_context.next=3;return userAPI.getUsers(currentPage,pageSize);case 3:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getUsersByPage=function getUsersByPage(pageNumber,pageSize){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(setCurrentPage(pageNumber));dispatch(toggleIsFetching(true));_context2.next=4;return userAPI.getUsers(pageNumber,pageSize);case 4:data=_context2.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var followUnfolloFlow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch,userId,apiMethod,actionCreator){var data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context3.next=3;return apiMethod(userId);case 3:data=_context3.sent;if(data.resultCode==0){dispatch(actionCreator(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function followUnfolloFlow(_x3,_x4,_x5,_x6){return _ref3.apply(this,arguments);};}();export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:followUnfolloFlow(dispatch,userId,userAPI.followUser.bind(userAPI),followSuccess);case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x7){return _ref4.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:followUnfolloFlow(dispatch,userId,userAPI.unfollowUser.bind(userAPI),unfollowSuccess);case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x8){return _ref5.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"names":["userAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","userId","followed","count","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setTotalUsersCount","toggleIsFetching","toggleFollowingProgress","requestUsers","dispatch","getUsers","data","items","totalCount","getUsersByPage","pageNumber","followUnfolloFlow","apiMethod","actionCreator","resultCode","follow","followUser","bind","unfollow","unfollowUser"],"sources":["/home/natalie/ReactProjects/01/my-app/src/redux/users-reducer.js"],"sourcesContent":["import { userAPI } from \"../api/api\";\nimport { updateObjectInArray } from \"../utils/object-helper\";\n\nconst FOLLOW = 'FOLLOW';\nconst UNFOLLOW = 'UNFOLLOW';\nconst SET_USERS = 'SET-USERS';\nconst SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\nconst SET_TOTAL_USERS_COUNT = 'SET-TOTAL-USERS-COUNT';\nconst TOGGLE_IS_FETCHING = 'TOGGLE-IS-FETCHING';\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE-IS-FOLLOWING-PROGRESS';\n\nlet initialState = {\n    users: [],\n    pageSize: 10,\n    totalUsersCount: 0,\n    currentPage: 1,\n    isFetching: true,\n    followingInProgress: []\n\n}\n\nconst usersReducer = (state = initialState, action) => {\n\n    switch (action.type) {\n        case FOLLOW:\n            return {\n                ...state,\n                users: updateObjectInArray(state.users, action.userId, \"id\", {followed: true})\n            }\n        case UNFOLLOW:\n            return {\n                ...state,\n                users: updateObjectInArray(state.users, action.userId, \"id\", {followed: false})\n            }\n        case SET_USERS:\n            return { ...state, users: action.users }\n        case SET_CURRENT_PAGE:\n            return { ...state, currentPage: action.currentPage }\n        case SET_TOTAL_USERS_COUNT:\n            return { ...state, totalUsersCount: action.count }\n        case TOGGLE_IS_FETCHING:\n            return { ...state, isFetching: action.isFetching }\n        case TOGGLE_IS_FOLLOWING_PROGRESS:\n            return { ...state, \n                followingInProgress: action.isFetching \n                ? [...state.followingInProgress, action.userId] \n                : state.followingInProgress.filter(id => id != action.userId)}\n        default:\n            return state;\n    }\n}\n\nexport const followSuccess = (userId) => ({type: FOLLOW, userId})\n\nexport const unfollowSuccess = (userId) => ({type: UNFOLLOW, userId})\n\nexport const setUsers = (users) => ({type: SET_USERS, users})\n\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\n\nexport const setTotalUsersCount = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, count: totalUsersCount})\n\nexport const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\n\nexport const toggleFollowingProgress = (isFetching, userId) => ({type: TOGGLE_IS_FOLLOWING_PROGRESS, isFetching, userId})\n\nexport const requestUsers = (currentPage, pageSize) => async (dispatch) => {\n\n    dispatch(toggleIsFetching(true));\n\n    let data = await userAPI.getUsers(currentPage, pageSize);\n\n    dispatch(toggleIsFetching(false));\n    dispatch(setUsers(data.items));\n    dispatch(setTotalUsersCount(data.totalCount));\n\n}\n\nexport const getUsersByPage = (pageNumber, pageSize) => async (dispatch) => {\n\n    dispatch(setCurrentPage(pageNumber));\n\n    dispatch(toggleIsFetching(true));\n\n    let data = await userAPI.getUsers(pageNumber, pageSize);\n\n    dispatch(toggleIsFetching(false));\n    dispatch(setUsers(data.items));\n\n}\n\nconst followUnfolloFlow = async (dispatch, userId, apiMethod, actionCreator) => {\n\n    dispatch(toggleFollowingProgress(true, userId));\n\n    let data = await apiMethod(userId);\n\n    if (data.resultCode == 0) {\n        dispatch(actionCreator(userId))\n    }\n\n    dispatch(toggleFollowingProgress(false, userId));\n}\n\nexport const follow = (userId) => async (dispatch) => {\n\n    followUnfolloFlow (dispatch, userId, userAPI.followUser.bind(userAPI), followSuccess);\n\n}\n\nexport const unfollow = (userId) => async (dispatch) => {\n\n    followUnfolloFlow (dispatch, userId, userAPI.unfollowUser.bind(userAPI), unfollowSuccess);\n\n}\n\nexport default usersReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}